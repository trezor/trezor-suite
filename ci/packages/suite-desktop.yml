suite-desktop lint:
    stage: lint and prettier
    script:
        - yarn workspace @trezor/suite-desktop lint
    dependencies:
        - install and build

suite-desktop type check:
    stage: typescript type check
    script:
        - yarn workspace @trezor/suite-desktop type-check
    dependencies:
        - install and build

suite-desktop build mac:
    stage: build desktop apps
    when: manual
    script:
        - yarn cache clean
        - yarn workspace @trezor/suite-data copy-static-files
        - yarn workspace @trezor/suite-desktop build:mac
    artifacts:
        expire_in: 1 day
        paths:
            - $PACKAGE_PATH_SUITE_DESKTOP/build-electron/mac/TrezorSuite
    dependencies:
        - install and build

suite-desktop build linux:
    stage: build desktop apps
    when: manual
    script:
        - yarn cache clean
        - yarn workspace @trezor/suite-data copy-static-files
        - yarn workspace @trezor/suite-desktop build:linux
        - sed -i "s/unstable-head/$CI_JOB_ID/g" trezor-suite.nix
    artifacts:
        expire_in: 1 day
        paths:
            - $PACKAGE_PATH_SUITE_DESKTOP/build-electron/linux
            - default.nix
            - trezor-suite.nix
    dependencies:
        - install and build

suite-desktop build windows:
    stage: build desktop apps
    when: manual
    script:
        - yarn cache clean
        - yarn workspace @trezor/suite-data copy-static-files
        - yarn workspace @trezor/suite-desktop build:win
    artifacts:
        expire_in: 1 day
        paths:
            - $PACKAGE_PATH_SUITE_DESKTOP/build-electron/win
            - default.nix
            - trezor-suite.nix
    dependencies:
        - install and build
