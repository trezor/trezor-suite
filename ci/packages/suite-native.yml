suite-native lint:
    stage: lint
    script:
        - yarn workspace @trezor/suite-native lint
  
suite-native type-check:
    stage: typescript type check
    script:
        - yarn workspace @trezor/suite-native type-check

suite-native unit tests:
    stage: unit tests
    script:
        - yarn workspace @trezor/suite-native test:unit

suite-native build android:
    image: reactnativecommunity/react-native-android
    stage: build
    script:
        - yarn cache clean
        - yarn build:libs
        - yarn workspace @trezor/suite-data copy-static-files
        - yarn workspace @trezor/suite-native build:android
        - mv $PACKAGE_PATH_SUITE_NATIVE/android/app/build/outputs/apk/release/app-release.apk .
    artifacts:
        expire_in: 1 day
        paths:
            - app-release.apk

suite-native deploy:
    stage: deploy to dev servers
    only:
        refs:
            - develop
            - schedules
    variables:
        DEPLOY_DIRECTORY: ${DEPLOY_BASE_DIR}/suite-native/${CI_BUILD_REF_NAME}
    script:
        - mkdir -p ${DEPLOY_DIRECTORY}
        - rsync --delete -va app-release.apk "${DEPLOY_DIRECTORY}/"
    tags:
        - deploy