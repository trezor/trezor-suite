!function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="./",t(t.s=0)}([function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.postModuleMessage=function(e,n){var t=e.id,r=e.message;d({id:t,message:r},{postMessage:n})};var r=t(1);"undefined"!=typeof onconnect&&(onconnect=function(e){var n=e.ports[0];n.onmessage=function(e){d(e.data,n)}});var o={},i={},u=null,s=Promise.resolve();function c(){var e=(0,r.create)();u=e,setTimeout((function(){return e.reject(new Error("Timed out"))}),1e4)}function f(e){null!=u&&u.resolve(e)}function a(){return null==u?Promise.reject(new Error("???")):u.promise}function l(e){var n=s.then((function(){return e()}));s=n.catch((function(){}))}function d(e,n){var t=e.id,r=e.message;if("acquire-intent"===r.type){var u=r.path,s=r.previous,d=r.debug;l((function(){return function(e,n,t,r,u){var s=!1,f=t?i:o,l=t?o:i,d=f[e];s=null==d?null!=n:n!==d;return s?(m({type:"wrong-previous-session"},r,u),Promise.resolve()):(c(),m({type:"other-session",otherSession:l[e]},r,u),a().then((function(n){if(n.good){var r=(++y).toString();t&&(r="debug"+r),f[e]=r,m({type:"session-number",number:r},n.id,u)}else m({type:"ok"},n.id,u)})))}(u,s,d,t,n)}))}if("acquire-done"===r.type&&function(e){f({good:!0,id:e})}(t),"acquire-failed"===r.type&&function(e){f({good:!1,id:e})}(t),"get-sessions"===r.type&&l((function(){return v(t,n)})),"get-sessions-and-disconnect"===r.type){var g=r.devices;l((function(){return v(t,n,g)}))}if("release-onclose"===r.type){var b=r.session;l((function(){return function(e){var n=null;if(Object.keys(o).forEach((function(t){o[t]===e&&(n=t)})),null==n)return Promise.resolve();var t=n;return delete o[t],delete i[t],Promise.resolve()}(b)}))}if("release-intent"===r.type){var h=r.session,P=r.debug;l((function(){return function(e,n,t,r){var u=null,s=n?i:o,f=n?o:i;if(Object.keys(s).forEach((function(n){s[n]===e&&(u=n)})),null==u)return m({type:"double-release"},t,r),Promise.resolve();var l=u,d=f[l];return c(),m({type:"path",path:l,otherSession:d},t,r),a().then((function(e){delete s[l],m({type:"ok"},e.id,r)}))}(h,P,t,n)}))}"release-done"===r.type&&p(t),"enumerate-intent"===r.type&&l((function(){return function(e,n){return c(),m({type:"ok"},e,n),a().then((function(e){m({type:"ok"},e.id,n)}))}(t,n)})),"enumerate-done"===r.type&&p(t)}function p(e){f({id:e})}function v(e,n,t){if(null!=t){var r={};t.forEach((function(e){r[e.path]=!0})),Object.keys(o).forEach((function(e){o[e]||delete o[e]})),Object.keys(i).forEach((function(e){i[e]||delete i[e]}))}return m({type:"sessions",debugSessions:i,normalSessions:o},e,n),Promise.resolve()}var y=0;function m(e,n,t){t.postMessage({id:n,message:e})}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.create=function(){var e=function(e){},n=function(e){},t=new Promise((function(t,r){e=t,n=r})),r=t.then((function(){throw new Error("Promise is always rejecting")}));return r.catch((function(){})),{resolve:e,reject:n,promise:t,rejectingPromise:r}},n.resolveTimeoutPromise=function(e,n){return new Promise((function(t){setTimeout((function(){t(n)}),e)}))},n.rejectTimeoutPromise=function(e,n){return new Promise((function(t,r){setTimeout((function(){r(n)}),e)}))}}]);