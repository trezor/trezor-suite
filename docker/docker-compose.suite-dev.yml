# schema version '3' does not support 'extends' keyword anymore
# https://stackoverflow.com/questions/52587643/how-to-extend-service-in-docker-compose-v3

version: '2'
services:
  trezor-env:
    build:
      context: . # . stands for pwd, so docker-compose must be called from root
      dockerfile: ./trezor-env/Dockerfile
    network_mode: "host"
    container_name: trezor-env
    environment: 
      - DISPLAY=$DISPLAY
      - QT_X11_NO_MITSHM=1
    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix:rw
    command: >
      bash -c "python3 ./main.py"

  suite-dev:
    build: 
      context: . 
      dockerfile: ./suite-dev/Dockerfile
    network_mode: "host"
    container_name: suite-dev
    volumes:
      - ../:/suite:ro
    command: "../run-inside.sh"
  